(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{112:function(t,e,i){"use strict";var s=i(0),n=i.n(s),o=i(17),h=Object(o.d)({ButtonGroup:t=>({display:t.inline?"inline-flex":"flex",flexWrap:"wrap",margin:"0 0.25rem","&>*":{flex:"1 1 auto","&:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0}}})});e.a=function(t){const{children:e,inline:i}=t,s=h({inline:i});return n.a.createElement("div",{className:s.ButtonGroup},e)}},171:function(t,e,i){"use strict";i.r(e);var s,n=i(49),o=i(30),h=i(44),a=i(112),c=i(14);!function(t){t[t.LEFT=0]="LEFT",t[t.MIDDLE=1]="MIDDLE",t[t.RIGHT=2]="RIGHT"}(s||(s={}));var r=i(15);function l(t,e){return t.x>=e.x&&t.x<=e.x+e.w&&t.y>=e.y&&t.y<=e.y+e.h}var u=i(16),d=i(48);class p extends class{constructor(t,e=!1,i=!1){this.rect=t,this.draggable=e,this.debug=i,this.active=!1}setContext(t){this.context=t}update(t){}render(){this.debug&&(this.context.save(),this.context.lineWidth=1,this.context.strokeStyle="red",this.context.strokeRect(this.rect.x,this.rect.y,this.rect.w,this.rect.h),this.context.restore())}isActive(){return this.active}onKeyDown(t){}onKeyUp(t){}onMouseMove(t){this.active&&(this.rect.x=t.x-this.rect.w/2,this.rect.y=t.y-this.rect.h/2)}onMouseDown(t,e){this.draggable&&l(e,this.rect)&&(this.active=!0)}onMouseUp(t,e){this.draggable&&l(e,this.rect)&&(this.active=!1)}onDoubleClick(t){}}{constructor(t,e,i,s,n,o=!1){super(Object.assign({},s),!0,o),this.aliveRect=s,this.deadRect=n,this.updatePlayer(t,e),this.image=i,this.rect.x=t.position.x,this.rect.y=t.position.y}updatePlayer(t,e){this.data=t,this.resetSectionId=e[0],this.deadSectionId=e[1],this.unusedSectionId=e[2],this.draggable=!0,t.section===this.deadSectionId?this.imageRect=this.deadRect:(this.imageRect=this.aliveRect,t.section===this.unusedSectionId&&(this.draggable=!1)),this.rect.w=this.imageRect.w,this.rect.h=this.imageRect.h}render(){super.render(),this.data.section!==this.unusedSectionId&&(this.context.save(),this.isActive()&&(this.context.shadowBlur=15,this.context.shadowColor="#C2D2E3"),this.context.drawImage(this.image,this.imageRect.x,this.imageRect.y,this.imageRect.w,this.imageRect.h,this.rect.x,this.rect.y,this.rect.w,this.rect.h),this.context.restore())}onDoubleClick(t){if(l(t,this.rect)&&this.data.section!==this.unusedSectionId){const t=Object(c.f)(d.a.getState());let e=this.resetSectionId;this.data.section===this.deadSectionId?d.a.dispatch(Object(c.p)(t.map(t=>Object.assign(Object.assign({},t),{players:t.id===this.deadSectionId?[...t.players.filter(t=>t.id!==this.data.color)]:t.id===this.resetSectionId?[...t.players,{id:this.data.color}]:[...t.players]})))):(d.a.dispatch(Object(c.p)(t.map(t=>Object.assign(Object.assign({},t),{players:t.id!==this.deadSectionId?[...t.players.filter(t=>t.id!==this.data.color)]:[...t.players,{id:this.data.color}]})))),e=this.deadSectionId),d.a.dispatch(Object(u.j)({player:this.data.color,newSection:e}))}}}class g{constructor(){this.animFrame=0,this.width=0,this.height=0,this.theSkeld=new Image,this.miraHQ=new Image,this.polus=new Image,this.players=new Image,this.loading=0,this.theSkeld.src="assets/images/TheSkeld.png",this.miraHQ.src="assets/images/MiraHQ.png",this.polus.src="assets/images/Polus.png",this.players.src="assets/images/players.png",this.theSkeld.onload=()=>{this.loading+=.25},this.miraHQ.onload=()=>{this.loading+=.25},this.polus.onload=()=>{this.loading+=.25},this.players.onload=()=>{this.loading+=.25},this.currentMap={position:{x:this.miraHQ.width/2,y:this.miraHQ.height/2},image:this.miraHQ},this.entities={};const t=d.a.getState(),e=Object(u.c)(t),i=Object(c.e)(t),s=Object(c.d)(t),n=Object(c.h)(t);for(const t in e){const o=e[t],h=r.b[t];this.entities[t+"Player"]=new p(o,[i,s,n],this.players,h.alive,h.dead)}this.lastTouched=0,this.touchCoordinates={x:0,y:0},this.panning=!1,this.lastPanClick={x:0,y:0}}static GetInstance(){return g.instance||(g.instance=new g),g.instance}setContext(t){this.context=t,this.width=this.context.canvas.width,this.height=this.context.canvas.height;for(const t in this.entities)this.entities[t].setContext(this.context)}setTheme(t){this.theme=t}getAnimFrame(){return this.animFrame}setCurrentMap(t){switch(t){case"Polus":this.currentMap.image=this.polus;break;case"TheSkeld":this.currentMap.image=this.theSkeld;break;default:this.currentMap.image=this.miraHQ}this.currentMap.position.x=this.currentMap.image.width/2,this.currentMap.position.y=this.currentMap.image.height/2}onMouseMove(t){t.preventDefault();const e=t.currentTarget.getBoundingClientRect(),i={x:(t.clientX-e.left)*(this.width/e.width),y:(t.clientY-e.top)*(this.height/e.height)};this.handleMouseMove(i)}onMouseDown(t){t.preventDefault();const e=t.currentTarget.getBoundingClientRect(),i={x:(t.clientX-e.left)*(this.width/e.width),y:(t.clientY-e.top)*(this.height/e.height)};this.handleMouseDown(t.button,i)}onMouseUp(t){t.preventDefault();const e=t.currentTarget.getBoundingClientRect(),i={x:(t.clientX-e.left)*(this.width/e.width),y:(t.clientY-e.top)*(this.height/e.height)};this.handleMouseUp(t.button,i)}onMouseLeave(t){if(t.preventDefault(),this.panning)this.panning=!1;else{const e=t.currentTarget.getBoundingClientRect(),i={x:(t.clientX-e.left)*(this.width/e.width),y:(t.clientY-e.top)*(this.height/e.height)},s={x:i.x+this.currentMap.position.x,y:i.y+this.currentMap.position.y};for(const e in this.entities)this.entities[e].onMouseUp(t.button,s)}}onDoubleClick(t){t.preventDefault();const e=t.currentTarget.getBoundingClientRect(),i={x:(t.clientX-e.left)*(this.width/e.width),y:(t.clientY-e.top)*(this.height/e.height)};this.handleDoubleClick(i)}onTouchMove(t){t.preventDefault();const e=t.currentTarget.getBoundingClientRect(),i={x:(t.touches[0].clientX-e.left)*(this.width/e.width),y:(t.touches[0].clientY-e.top)*(this.height/e.height)};this.handleMouseMove(i),this.touchCoordinates=i}onTouchStart(t){t.preventDefault();const e=t.currentTarget.getBoundingClientRect(),i={x:(t.touches[0].clientX-e.left)*(this.width/e.width),y:(t.touches[0].clientY-e.top)*(this.height/e.height)};this.handleMouseDown(s.LEFT,i),this.touchCoordinates=i}onTouchEnd(t){t.preventDefault();const e=(new Date).getTime(),i=e-this.lastTouched;this.handleMouseUp(s.LEFT,this.touchCoordinates),i<500&&i>0&&this.handleDoubleClick(this.touchCoordinates),this.lastTouched=e}onTouchCancel(t){t.preventDefault(),this.handleMouseUp(s.LEFT,this.touchCoordinates)}onWheel(t){}updatePlayers(){const t=d.a.getState(),e=Object(u.c)(t),i=Object(c.e)(t),s=Object(c.d)(t),n=Object(c.h)(t);for(const t of Object.keys(e)){const o=e[t];this.entities[t+"Player"].updatePlayer(o,[i,s,n])}}init(){if(void 0===this.context&&null===this.context||void 0===this.theme&&null===this.theme)throw new Error("Context and theme must be set before initializing the animation.");this.loop(0)}handleMouseMove(t){const e={x:t.x+this.currentMap.position.x,y:t.y+this.currentMap.position.y};if(this.panning)this.currentMap.position.x+=this.lastPanClick.x-t.x,this.currentMap.position.y+=this.lastPanClick.y-t.y,this.currentMap.position.x=Math.max(Math.min(this.currentMap.image.width-this.width,this.currentMap.position.x),0),this.currentMap.position.y=Math.max(Math.min(this.currentMap.image.height-this.height,this.currentMap.position.y),0),this.lastPanClick=t;else for(const t in this.entities)this.entities[t].onMouseMove(e)}handleMouseDown(t,e){const i={x:e.x+this.currentMap.position.x,y:e.y+this.currentMap.position.y};let s=!0;for(const e in this.entities)if(this.entities[e].onMouseDown(t,i),this.entities[e].isActive()){s=!1;break}this.panning=s,this.lastPanClick=e}handleMouseUp(t,e){if(this.panning)this.panning=!1;else{const i={x:e.x+this.currentMap.position.x,y:e.y+this.currentMap.position.y};for(const e in this.entities)this.entities[e].onMouseUp(t,i)}}handleDoubleClick(t){const e={x:t.x+this.currentMap.position.x,y:t.y+this.currentMap.position.y};for(const t in this.entities)this.entities[t].onDoubleClick(e)}update(t){for(const e in this.entities)this.entities[e].update(t)}render(){if(this.context.clearRect(0,0,this.width,this.height),this.loading<1)this.context.fillStyle=this.theme.textColorPrimary,this.context.font="50px "+this.theme.fontFamily,this.context.fillText("Loading...",this.width/2-50,this.height/2-10);else{this.context.save(),this.context.translate(-this.currentMap.position.x,-this.currentMap.position.y),this.context.drawImage(this.currentMap.image,0,0);for(const t in this.entities)this.entities[t].render();this.context.restore()}}loop(t){m.update(t),m.render(),m.animFrame=window.requestAnimationFrame(m.loop)}}const m=g.GetInstance();var x=m,M=i(0),f=i.n(M),y=i(17),b=Object(y.d)(t=>({Map:{width:"100%",height:"100%",maxHeight:"calc((var(--vh, 1vh) * 100) - 9rem)",fallbacks:{maxHeight:"calc(100vh - 9rem)"},overscrollBehavior:"none",touchAction:"none"},MapImage:{display:"none"}}));var w=function(){const t=b(),e=Object(y.f)(),i=Object(o.c)(n.b),s=Object(o.c)(u.c),h=Object(o.c)(c.e),a=Object(o.c)(c.d),r=Object(o.c)(c.h),l=f.a.useRef(null);return f.a.useEffect(()=>{if(null!==l.current){const t=l.current.getContext("2d");if(null!=t)return x.setContext(t),x.setTheme(e),x.init(),()=>{cancelAnimationFrame(x.getAnimFrame())}}},[]),f.a.useEffect(()=>{x.setTheme(e)},[e]),f.a.useEffect(()=>{x.setCurrentMap(i)},[i]),f.a.useEffect(()=>{x.updatePlayers()},[s,h,a,r]),f.a.createElement("canvas",{ref:l,width:1920,height:1080,className:t.Map,onContextMenu:t=>t.preventDefault(),onMouseMove:t=>x.onMouseMove(t),onMouseDown:t=>x.onMouseDown(t),onMouseUp:t=>x.onMouseUp(t),onMouseLeave:t=>x.onMouseLeave(t),onDoubleClick:t=>x.onDoubleClick(t),onTouchMove:t=>x.onTouchMove(t),onTouchStart:t=>x.onTouchStart(t),onTouchEnd:t=>x.onTouchEnd(t),onTouchCancel:t=>x.onTouchCancel(t),onWheel:t=>x.onWheel(t)},"This section is not supported on your browser.")},v=i(26),C=Object(y.d)({Maps:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"1rem",flexGrow:1},MapsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},MapsTitle:{fontSize:"1.25rem",fontWeight:500,letterSpacing:"0.05em",marginRight:"1rem",flex:"1 0 auto"},MapsContainer:{flexGrow:1}}),T=i(100);e.default=function(){const t=Object(o.c)(v.b),e=Object(o.c)(n.b),i=Object(o.b)(),s=C(),{t:c}=Object(T.a)();return f.a.createElement("div",{className:s.Maps},f.a.createElement("div",{className:s.MapsHeader},!t&&f.a.createElement("h2",{className:s.MapsTitle},c("maps.title")),f.a.createElement(a.a,{inline:!t},f.a.createElement(h.b,{pressed:"TheSkeld"===e,onClick:()=>i(Object(n.c)("TheSkeld"))},"The Skeld"),f.a.createElement(h.b,{pressed:"MiraHQ"===e,onClick:()=>i(Object(n.c)("MiraHQ"))},"Mira HQ"),f.a.createElement(h.b,{pressed:"Polus"===e,onClick:()=>i(Object(n.c)("Polus"))},"Polus"))),f.a.createElement("div",{className:s.MapsContainer},f.a.createElement(w,null)))}}}]);